<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jeff Jacobs">

<title>Mathematical Optimization – DSAN 5300-01</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-8ea72dc5fed832574809a9c94082fbbb.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-31e7ef5b61105ecb20b18646b337abf7.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-4e547ae55f435f3091261ad18d05919a.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/dreampulse/computer-modern-web-font@master/fonts.css"><script src="../../sidebar.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">
      DSAN 5300-01: Statistical Learning
      </li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">DSAN 5300-01: Statistical Learning</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><i class="bi bi-house pe-1"></i> Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://georgetown.zoom.us/j/91911785762?pwd=poQh2m4AiSYWaDudp7hPLDEszWgBuG.1" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Zoom Link</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../writeups/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Writeups</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://georgetown.hosted.panopto.com/Panopto/Pages/Sessions/List.aspx?folderID=07b596c2-6a0e-4302-a186-b25c00b555ce" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Recordings <i class="bi bi-box-arrow-up-right ps-1"></i></span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../w01/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 1: Jan 9</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../w02/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 2: Jan 13</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../w03/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 3: Jan 27</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../w04/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 4: Feb 3</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../w05/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 5: Feb 10</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../w06/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 6: Feb 18</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../w07/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 7: Feb 24</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../w08/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 8: Mar 10</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../w09/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 9: Mar 17</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://georgetown.instructure.com/courses/203361" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Canvas <i class="bi bi-box-arrow-up-right ps-1"></i></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://jjacobs.me/meet" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Office Hours <i class="bi bi-box-arrow-up-right ps-1"></i></span></a>
  </div>
</li>
    </ul>
    </div>
<div class="quarto-sidebar-footer"><div class="sidebar-footer-item">
<p><em>Updated 2025-03-24, 06:04:10 AM</em></p>
</div></div></nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#motivation-a-closer-look-at-parameter-estimation" id="toc-motivation-a-closer-look-at-parameter-estimation" class="nav-link active" data-scroll-target="#motivation-a-closer-look-at-parameter-estimation">Motivation: A Closer Look at Parameter Estimation</a></li>
  <li><a href="#visualizing-unconstrained-and-constrained-optimization" id="toc-visualizing-unconstrained-and-constrained-optimization" class="nav-link" data-scroll-target="#visualizing-unconstrained-and-constrained-optimization">Visualizing Unconstrained and Constrained Optimization</a></li>
  <li><a href="#general-unconstrained-optimization" id="toc-general-unconstrained-optimization" class="nav-link" data-scroll-target="#general-unconstrained-optimization">General Unconstrained Optimization</a></li>
  <li><a href="#maximum-likelihood-estimation-as-unconstrained-optimization" id="toc-maximum-likelihood-estimation-as-unconstrained-optimization" class="nav-link" data-scroll-target="#maximum-likelihood-estimation-as-unconstrained-optimization">Maximum Likelihood Estimation as Unconstrained Optimization</a>
  <ul class="collapse">
  <li><a href="#standard-example-poisson-distribution" id="toc-standard-example-poisson-distribution" class="nav-link" data-scroll-target="#standard-example-poisson-distribution">“Standard” Example: Poisson Distribution</a></li>
  <li><a href="#trickier-example-linear-regression" id="toc-trickier-example-linear-regression" class="nav-link" data-scroll-target="#trickier-example-linear-regression">Trickier Example: Linear Regression</a></li>
  </ul></li>
  <li><a href="#general-constraints-only-optimization" id="toc-general-constraints-only-optimization" class="nav-link" data-scroll-target="#general-constraints-only-optimization">General Constraints-Only Optimization</a></li>
  <li><a href="#gmm-estimation-as-constraints-only-optimization" id="toc-gmm-estimation-as-constraints-only-optimization" class="nav-link" data-scroll-target="#gmm-estimation-as-constraints-only-optimization">GMM Estimation as Constraints-Only Optimization</a></li>
  <li><a href="#general-constrained-optimization" id="toc-general-constrained-optimization" class="nav-link" data-scroll-target="#general-constrained-optimization">General Constrained Optimization</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jpowerj/dsan5300-01/blob/main/writeups/optimization/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Mathematical Optimization</h1>
<p class="subtitle lead">A ‘Bridge’ to DSAN 5300 (<em>Statistical Learning</em>)</p>
  <div class="quarto-categories">
    <div class="quarto-category">Extra Writeups</div>
  </div>
  </div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Jeff Jacobs </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="mailto:jj1088@georgetown.edu" target="_blank"><code>jj1088@georgetown.edu</code></a>
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  


</header>


<section id="motivation-a-closer-look-at-parameter-estimation" class="level2">
<h2 class="anchored" data-anchor-id="motivation-a-closer-look-at-parameter-estimation">Motivation: A Closer Look at Parameter Estimation</h2>
<div class="hidden">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"../../dsan-globals/_globals.r"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="hidden">
<p><span class="math display">\[
\DeclareMathOperator*{\argmax}{argmax}
\DeclareMathOperator*{\argmin}{argmin}
\newcommand{\bigexp}[1]{\exp\mkern-4mu\left[ #1 \right]}
\newcommand{\bigexpect}[1]{\mathbb{E}\mkern-4mu \left[ #1 \right]}
\newcommand{\definedas}{\overset{\small\text{def}}{=}}
\newcommand{\definedalign}{\overset{\phantom{\text{defn}}}{=}}
\newcommand{\eqeventual}{\overset{\text{eventually}}{=}}
\newcommand{\Err}{\text{Err}}
\newcommand{\expect}[1]{\mathbb{E}[#1]}
\newcommand{\expectsq}[1]{\mathbb{E}^2[#1]}
\newcommand{\fw}[1]{\texttt{#1}}
\newcommand{\given}{\mid}
\newcommand{\green}[1]{\color{green}{#1}}
\newcommand{\heads}{\outcome{heads}}
\newcommand{\iid}{\overset{\text{\small{iid}}}{\sim}}
\newcommand{\lik}{\mathcal{L}}
\newcommand{\loglik}{\ell}
\DeclareMathOperator*{\maximize}{maximize}
\DeclareMathOperator*{\minimize}{minimize}
\newcommand{\mle}{\textsf{ML}}
\newcommand{\nimplies}{\;\not\!\!\!\!\implies}
\newcommand{\orange}[1]{\color{orange}{#1}}
\newcommand{\outcome}[1]{\textsf{#1}}
\newcommand{\param}[1]{{\color{purple} #1}}
\newcommand{\pgsamplespace}{\{\green{1},\green{2},\green{3},\purp{4},\purp{5},\purp{6}\}}
\newcommand{\prob}[1]{P\left( #1 \right)}
\newcommand{\purp}[1]{\color{purple}{#1}}
\newcommand{\sign}{\text{Sign}}
\newcommand{\spacecap}{\; \cap \;}
\newcommand{\spacewedge}{\; \wedge \;}
\newcommand{\tails}{\outcome{tails}}
\newcommand{\Var}[1]{\text{Var}[#1]}
\newcommand{\bigVar}[1]{\text{Var}\mkern-4mu \left[ #1 \right]}
\]</span></p>
</div>
</div>
<p>As we entered the unit on Parameter Estimation, encompassing both <strong>Maximum Likelihood Estimation (MLE)</strong> and <strong>Generalized Method of Moments (GMM) Estimation</strong>, a bunch of students helpfully pointed out how the mathematical content of the course suddenly kind of “shifted into high gear”.</p>
<p>So, although it won’t help in terms of the Quizzes and Labs you’ve already completed on these topics, I think it <em>is</em> helpful to return to the mathematical aspects of those units, since they will become fairly central to the problems you’ll encounter in <strong><em>DSAN 5300: Statistical Learning</em></strong>, in the Spring semester.</p>
<p>My goals here are:</p>
<ul>
<li>To start specifically with the Maximum Likelihood Estimation approach, going more slowly through some example problems emphasizing how MLE is rooted in <strong>optimization</strong> of an <strong>objective function</strong>, and then</li>
<li>To introduce <strong>constrained</strong> optimization via the <strong>Lagrange Multiplier</strong> approach, as the “next step” once you feel comfortable with MLE, again going through example problems that can then also serve as preparation for DSAN 5300!</li>
</ul>
<p>The second bullet point is why I also mentioned <strong>GMM Estimation</strong> above: it turns out that, whereas <strong>MLE</strong> is an optimization problem <strong>without</strong> constraints, <strong>GMM</strong> can essentially be written as an optimization problem with <strong>only</strong> constraints.</p>
<p>As a preview of what this means, first assume we have:</p>
<ul>
<li>A vector-valued Random Variable <span class="math inline">\(\mathfrak{X}\)</span>,</li>
<li>An <span class="math inline">\(N\)</span>-dimensional vector <span class="math inline">\(\mathbf{x} = (x_1, \ldots, x_N)\)</span>, our dataset (a <strong>realization</strong> of <span class="math inline">\(\mathfrak{X}\)</span>),</li>
<li>A vector of <span class="math inline">\(J\)</span> parameters <span class="math inline">\(\param{\boldsymbol\theta} = (\theta_1, \ldots, \theta_J)\)</span>,
<ul>
<li>For example, if <span class="math inline">\(\mathfrak{X}\)</span> is distributed normally, it has <span class="math inline">\(J = 2\)</span> parameters <span class="math inline">\(\param{\boldsymbol\theta} = (\theta_1, \theta_2) = (\mu, \sigma)\)</span></li>
</ul></li>
<li>A likelihood function <span class="math inline">\(\mathcal{L}(\mathfrak{X} = \mathbf{x} \mid \param{\boldsymbol\theta})\)</span>.</li>
</ul>
<p>You can compare <strong>MLE</strong> for this scenario, written in the form of an optimization problem:</p>
<p><span class="math display">\[
\begin{alignat}{2}
\boldsymbol\theta^* = &amp;&amp;\max_{\param{\boldsymbol\theta}} \quad &amp;\mathcal{L}(\mathfrak{X} = \mathbf{x} \mid \param{\boldsymbol\theta}) \\
&amp;&amp; \text{s.t.} \quad &amp;\varnothing
\end{alignat}
\]</span></p>
<p>with <strong>GMM</strong> estimation for this scenario written in the same form:</p>
<p><span class="math display">\[
\begin{alignat}{2}
\boldsymbol\theta^* = &amp;&amp;\max_{\param{\boldsymbol\theta}} \quad &amp;\varnothing \\
&amp;&amp; \text{s.t.} \quad &amp; \mu_1(\param{\boldsymbol\theta}) = \widehat{\mu}_1(\mathbf{x}, \param{\boldsymbol\theta}) \\
&amp;&amp; \quad &amp; \mu_2(\param{\boldsymbol\theta}) = \widehat{\mu}_2(\mathbf{x}, \param{\boldsymbol\theta}) \\
&amp;&amp; \quad &amp; \phantom{\mu_1(\param{\boldsymbol\theta})} ~ \vdots \\
&amp;&amp; \quad &amp; \mu_J(\param{\boldsymbol\theta}) = \widehat{\mu}_J(\mathbf{x}, \param{\boldsymbol\theta}),
\end{alignat}
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\mu_i(\param{\boldsymbol\theta})\)</span> is the <span class="math inline">\(i\)</span>th <strong>theoretical</strong> moment of <span class="math inline">\(\mathfrak{X}\)</span>
<ul>
<li>For example, if <span class="math inline">\(\mathfrak{X}\)</span> is distributed normally, <span class="math inline">\(\mu_1(\theta_1, \theta_2) = \mathbb{E}[\mathfrak{X}]\)</span></li>
</ul></li>
<li><span class="math inline">\(\widehat{\mu}_i(\mathbf{x}, \param{\boldsymbol\theta})\)</span> is the <span class="math inline">\(i\)</span>th <strong>empirical</strong> moment of <span class="math inline">\(\mathfrak{X}\)</span>
<ul>
<li>For example, since <span class="math inline">\(\mu_1 = \mathbb{E}[\mathfrak{X}]\)</span>, <span class="math inline">\(\widehat{\mu_1}\)</span> is the sample “version” of <span class="math inline">\(\mathbb{E}[\mathfrak{X}]\)</span>, namely, <span class="math inline">\(\widehat{\mu}_1 = \frac{1}{N}\sum_{i=1}^{N}x_i\)</span></li>
</ul></li>
</ul>
<p>In both cases, the symbol <span class="math inline">\(\varnothing\)</span> literally just means “nothing”: in the MLE case, we have no constraints, whereas in the GMM estimation case, we have no objective function.</p>
<p>For readability, <span class="math inline">\(\text{s.t.}\)</span> is just shorthand for “subject to”, or sometimes “such that”. This means that the full expression in general can be read like <em>“<span class="math inline">\(\param{\boldsymbol\theta}^*\)</span> is the maximum of ____, subject to _____”</em></p>
</section>
<section id="visualizing-unconstrained-and-constrained-optimization" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-unconstrained-and-constrained-optimization">Visualizing Unconstrained and Constrained Optimization</h2>
<p>The <strong>unconstrained</strong> optimizations we will carry out here can be visualized as “hill climbing”: the optimization approach you probably learned in calculus class—computing the derivative and setting it equal to zero—works precisely because the top of the “hill” is the point at which the derivative becomes zero. For example, if we started climbing from the left side of the following plot, the derivative would get lower and lower as we moved right, hitting zero when we reach the top of the “hill”:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="sc">|&gt;</span> <span class="fu">suppressPackageStartupMessages</span>()</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>my_hill <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(<span class="sc">-</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>my_slope <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="sc">-</span>x<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>x0_vals <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.75</span>, <span class="sc">-</span><span class="fl">0.333</span>, <span class="dv">0</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>tangent_at_x0 <span class="ot">&lt;-</span> <span class="cf">function</span>(x,x0) <span class="fu">my_slope</span>(x0)<span class="sc">*</span>(x <span class="sc">-</span> x0) <span class="sc">+</span> <span class="fu">my_hill</span>(x0)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>tan_x1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">tangent_at_x0</span>(x, x0_vals[<span class="dv">1</span>])</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>tan_x2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">tangent_at_x0</span>(x, x0_vals[<span class="dv">2</span>])</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>tan_x3 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">tangent_at_x0</span>(x, x0_vals[<span class="dv">3</span>])</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>eval_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x=</span>x0_vals) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">y=</span><span class="fu">my_hill</span>(x))</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>tan_ext <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>slopes <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_slope</span>(x0_vals[<span class="dv">1</span>]),</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_slope</span>(x0_vals[<span class="dv">2</span>]),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_slope</span>(x0_vals[<span class="dv">3</span>])</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>), <span class="dv">3</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>opt_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="fu">my_hill</span>(<span class="dv">0</span>))</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>x_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>x_df <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x)) <span class="sc">+</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun=</span>my_hill, <span class="at">linewidth=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun=</span>tan_x1, <span class="fu">aes</span>(<span class="at">color=</span><span class="st">"x1"</span>), <span class="at">linewidth=</span><span class="dv">1</span>,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlim=</span><span class="fu">c</span>(</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>      x0_vals[<span class="dv">1</span>]<span class="sc">-</span>tan_ext,</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>      x0_vals[<span class="dv">1</span>]<span class="sc">+</span>tan_ext</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun=</span>tan_x2, <span class="fu">aes</span>(<span class="at">color=</span><span class="st">"x2"</span>), <span class="at">linewidth=</span><span class="dv">1</span>,</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlim=</span><span class="fu">c</span>(</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>      x0_vals[<span class="dv">2</span>]<span class="sc">-</span>tan_ext,</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>      x0_vals[<span class="dv">2</span>]<span class="sc">+</span>tan_ext</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun=</span>tan_x3, <span class="fu">aes</span>(<span class="at">color=</span><span class="st">"x3"</span>), <span class="at">linewidth=</span><span class="dv">1</span>,</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlim=</span><span class="fu">c</span>(</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>eval_df,</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">color=</span><span class="fu">c</span>(<span class="st">"x1"</span>,<span class="st">"x2"</span>,<span class="st">"x3"</span>)),</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span><span class="dv">2</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>opt_df,</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">shape=</span><span class="st">"mle"</span>),</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span><span class="dv">2</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">element_blank</span>(),</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">values=</span><span class="dv">19</span>,</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels=</span><span class="st">"MLE Estimate"</span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Slope at x"</span>,</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">values=</span><span class="fu">c</span>(cb_palette[<span class="dv">1</span>], cb_palette[<span class="dv">2</span>], cb_palette[<span class="dv">3</span>]),</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels=</span>slopes</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size=</span><span class="dv">18</span>) <span class="sc">+</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.15</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/hill-climbing-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>The derivatives “point” in the direction you should go to get to the maximum value, at which it has value zero</figcaption>
</figure>
</div>
</div>
</div>
<p>Using this same metaphor of the top of a hill being the “best” point, <strong>constrained</strong> optimization is a bit harder to visualize, but you can think of it like:</p>
<ul>
<li>Getting (almost) crunched between two walls coming closer together, then</li>
<li>Getting (almost) crunched between a floor and a ceiling coming closer together,</li>
</ul>
<p>where that coming-closer-together is set up so as to crunch the space, making it smaller and smaller until the only point(s) left are the point(s) representing the optimal solution:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>xl <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.06</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>xu <span class="ot">&lt;-</span> <span class="fl">0.06</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>yl <span class="ot">&lt;-</span> <span class="fl">0.985</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>yu <span class="ot">&lt;-</span> <span class="fl">1.015</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>anno_x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">1.8</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>anno_y <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>x_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>rib_df <span class="ot">&lt;-</span> x_df <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">ymin =</span> <span class="sc">-</span><span class="fl">0.1</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">ymax =</span> <span class="fl">0.1</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>x_df <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x)) <span class="sc">+</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun=</span>my_hill, <span class="at">linewidth=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill=</span><span class="st">"x"</span>), <span class="at">xmin=</span>xl, <span class="at">xmax=</span>xu, <span class="at">ymin=</span><span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax=</span><span class="cn">Inf</span>, <span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">color=</span><span class="st">'black'</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x=</span>xl, <span class="at">xend=</span>xl, <span class="at">y=</span><span class="sc">-</span><span class="cn">Inf</span>, <span class="at">yend=</span><span class="cn">Inf</span>) <span class="sc">+</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x=</span>xu, <span class="at">xend=</span>xu, <span class="at">y=</span><span class="sc">-</span><span class="cn">Inf</span>, <span class="at">yend=</span><span class="cn">Inf</span>) <span class="sc">+</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill=</span><span class="st">"y"</span>), <span class="at">xmin=</span><span class="sc">-</span><span class="cn">Inf</span>, <span class="at">xmax=</span><span class="cn">Inf</span>, <span class="at">ymin=</span>yl, <span class="at">ymax=</span>yu, <span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">color=</span><span class="st">'black'</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x=</span><span class="sc">-</span><span class="cn">Inf</span>, <span class="at">xend=</span><span class="cn">Inf</span>, <span class="at">y=</span>yl, <span class="at">yend=</span>yl) <span class="sc">+</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x=</span><span class="sc">-</span><span class="cn">Inf</span>, <span class="at">xend=</span><span class="cn">Inf</span>, <span class="at">y=</span>yu, <span class="at">yend=</span>yu) <span class="sc">+</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Anno xmin</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"segment"</span>, <span class="at">y=</span>anno_y, <span class="at">yend=</span>anno_y, <span class="at">x =</span> xl<span class="fl">-0.5</span>, <span class="at">xend =</span> xl<span class="fl">-0.04</span>,</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth=</span><span class="dv">1</span>, <span class="at">linejoin =</span> <span class="st">"mitre"</span>,</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.02</span>, <span class="st">"npc"</span>))</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">"text"</span>, <span class="at">y=</span>anno_y, <span class="at">x=</span>xl<span class="fl">-1.2</span>, <span class="at">label =</span> <span class="st">"x &gt; a"</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust=</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Anno xmax</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">"segment"</span>, <span class="at">y=</span>anno_y, <span class="at">yend=</span>anno_y, <span class="at">x =</span> xu<span class="fl">+0.5</span>, <span class="at">xend =</span> xu<span class="fl">+0.04</span>,</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth=</span><span class="dv">1</span>, <span class="at">linejoin =</span> <span class="st">"mitre"</span>,</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.02</span>, <span class="st">"npc"</span>))</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">"text"</span>, <span class="at">y=</span>anno_y, <span class="at">x=</span>xu<span class="fl">+0.6</span>, <span class="at">label =</span> <span class="st">"x &lt; b"</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust=</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Anno ymin</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>    <span class="st">"segment"</span>, <span class="at">x=</span>anno_x, <span class="at">xend=</span>anno_x, <span class="at">y =</span> yl<span class="fl">-0.2</span>, <span class="at">yend =</span> yl<span class="fl">-0.015</span>,</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth=</span><span class="dv">1</span>, <span class="at">linejoin =</span> <span class="st">"mitre"</span>,</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.02</span>, <span class="st">"npc"</span>))</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>    <span class="st">"text"</span>, <span class="at">x=</span>anno_x, <span class="at">y=</span>yl<span class="fl">-0.25</span>, <span class="at">label =</span> <span class="st">"y &gt; c"</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust=</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Anno ymax</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>    <span class="st">"segment"</span>, <span class="at">x=</span>anno_x, <span class="at">xend=</span>anno_x, <span class="at">y =</span> yu<span class="fl">+0.2</span>, <span class="at">yend =</span> yu<span class="fl">+0.015</span>,</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth=</span><span class="dv">1</span>, <span class="at">linejoin =</span> <span class="st">"mitre"</span>,</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.02</span>, <span class="st">"npc"</span>))</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>    <span class="st">"text"</span>, <span class="at">x=</span>anno_x, <span class="at">y=</span>yu<span class="fl">+0.2</span>, <span class="at">label =</span> <span class="st">"y &lt; d"</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Constraints:"</span>,</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">values=</span><span class="fu">c</span>(cb_palette[<span class="dv">1</span>], cb_palette[<span class="dv">2</span>]),</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"a &lt; x &lt; b"</span>, <span class="st">"c &lt; y &lt; d"</span>)</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>opt_df,</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">shape=</span><span class="st">"gmm"</span>),</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span><span class="dv">2</span></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">element_blank</span>(),</span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">values=</span><span class="dv">19</span>,</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels=</span><span class="st">"GMM Estimate"</span></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size=</span><span class="dv">18</span>) <span class="sc">+</span></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/hill-constraints-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>The constraints “crunch” the admissible values of <span class="math inline">\(x\)</span> until only one point (the Method of Moments estimate) is left. The metaphor is a bit more contrived in this case, however, since we usually don’t manually compute these constraints in exactly this form (they are <strong>implicit</strong> in the GMM’s system of equations), though numerically (i.e., if we use R to compute the GMM estimate), this <em>is</em> exactly how the constraints would be applied!</figcaption>
</figure>
</div>
</div>
</div>
<p>Let’s look at how we can work through both MLE and GMM estimation (which we previously learned separately!) as optimization problems, and how that will give us a <strong>unified</strong> optimization framework for estimating parameters in the fancier ML models you’ll see in DSAN 5300!</p>
</section>
<section id="general-unconstrained-optimization" class="level2">
<h2 class="anchored" data-anchor-id="general-unconstrained-optimization">General Unconstrained Optimization</h2>
<p>As the name implies, <strong>Maximum</strong> likelihood estimation involves <strong>maximizing</strong> something:</p>
<ul>
<li>In MLE, that thing is the <strong>Likelihood Function</strong> <span class="math inline">\(\mathcal{L}(X \mid \theta)\)</span>.</li>
<li>In optimization, more generally, that thing is called the <strong>objective function</strong> <span class="math inline">\(f(x, \theta)\)</span>.</li>
</ul>
<p>This is the reasoning behind something I might have mentioned in class in earlier weeks, that <em>“the objective function in MLE is the likelihood function”</em>.</p>
<p>In other words, when you see the term <em>“objective function”</em>, just replace it in your brain with <em>“thing I’m trying to optimize (minimize or maximize) here”</em>.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>Before we look at MLE specifically, therefore, let’s look at a general unconstrained optimization problem, something you almost surely have already solved tons of times (even if you didn’t have the vocabulary of optimization, objective functions, constraints, and so on):</p>
<div class="callout callout-style-default callout-note callout-titled" title="Example 1: General Unconstrained Optimization">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example 1: General Unconstrained Optimization
</div>
</div>
<div class="callout-body-container callout-body">
<p>Find <span class="math inline">\(x^*\)</span>, the solution to</p>
<p><span class="math display">\[
\begin{align}
    \min_{x} ~ &amp; f(x) = 3x^2 - x \\
    \text{s.t. } ~ &amp; \varnothing
\end{align}
\]</span></p>
</div>
</div>
<p>From calculus, we know that finding the <strong>optimum</strong> value for a function like this (whether minimum or maximum) boils down to:</p>
<ul>
<li>Computing the derivative <span class="math inline">\(f'(x) = \frac{\partial}{\partial x}f(x)\)</span>,</li>
<li>Setting it equal to zero: <span class="math inline">\(f'(x) = 0\)</span>, and</li>
<li>Solving this equal for <span class="math inline">\(x\)</span>, i.e., finding values <span class="math inline">\(x^*\)</span> which satisfy <span class="math inline">\(f'(x^*) = 0\)</span></li>
</ul>
<p>Here, without any constraints, we can follow this exact procedure to find the minimum value. We start by computing the derivative:</p>
<p><span class="math display">\[
f'(x) = \frac{\partial}{\partial x}f(x) = \frac{\partial}{\partial x}\left[3x^2 - x\right] = 6x - 1,
\]</span></p>
<p>then solve for <span class="math inline">\(x^*\)</span> as the value(s) satisfying <span class="math inline">\(\frac{\partial}{\partial x}f'(x^*) = 0\)</span> for the just-derived <span class="math inline">\(f'(x)\)</span>:</p>
<p><span class="math display">\[
f'(x^*) = 0 \iff 6x^* - 1 = 0 \iff x^* = \frac{1}{6}.
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled" title="Derivative Cheatsheet (Click to Collapse / Expand)">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Derivative Cheatsheet (Click to Collapse / Expand)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p><em>(These green boxes are where I get to pop off a tiny bit, but in a way that I hope is helpful! 😜)</em></p>
<p>Personally, I absolutely <em>hate</em>, <em>despise</em> memorizing things. So much of school growing up felt like memorizing a ton of things for no reason, since they were things we could just Google 90% of the time…</p>
<p>So, even though people usually associate math with memorization of formulas, for whatever reason I have the opposite association: math was the one class where I <strong>didn’t</strong> have to memorize things, because (unlike… “the mitochondria is the powerhouse of the cell”) I had really good teachers who always walked us through how to <strong>derive</strong> things from more basic principles.</p>
<p>So, I’m providing this here as a small set of “shortcuts”, but long story short each of these can be derived from even simpler procedures (I don’t want to clutter this writeup even more by writing those out, but I’m happy to walk you through how you could derive these, in office hours for example!)</p>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Type of Thing</th>
<th style="text-align: center;">Thing</th>
<th style="text-align: center;">Change in Thing when <span class="math inline">\(x\)</span> Changes by Tiny Amount</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Polynomial</td>
<td style="text-align: center;"><span class="math inline">\(f(x) = x^n\)</span></td>
<td style="text-align: center;"><span class="math inline">\(f'(x) = \frac{\partial}{\partial x}f(x) = nx^{n-1}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Fraction</td>
<td style="text-align: center;"><span class="math inline">\(f(x) = \frac{1}{x}\)</span></td>
<td style="text-align: center;">Use Polynomial rule (since <span class="math inline">\(\frac{1}{x} = x^{-1}\)</span>) to get <span class="math inline">\(f'(x) = -\frac{1}{x^2}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Logarithm</td>
<td style="text-align: center;"><span class="math inline">\(f(x) = \ln(x)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(f'(x) = \frac{\partial}{\partial x} = \frac{1}{x}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Exponential</td>
<td style="text-align: center;"><span class="math inline">\(f(x) = e^x\)</span></td>
<td style="text-align: center;"><span class="math inline">\(f'(x) = \frac{\partial}{\partial x}e^x = e^x\)</span> (🧐❗️)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Multiplication</td>
<td style="text-align: center;"><span class="math inline">\(f(x) = g(x)h(x)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(f'(x) = g'(x)h(x) + g(x)h'(x)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Division</td>
<td style="text-align: center;"><span class="math inline">\(f(x) = \frac{g(x)}{h(x)}\)</span></td>
<td style="text-align: center;">Too hard to memorize… turn it into Multiplication, as <span class="math inline">\(f(x) = g(x)(h(x))^{-1}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Composition (Chain Rule)</td>
<td style="text-align: center;"><span class="math inline">\(f(x) = g(h(x))\)</span></td>
<td style="text-align: center;"><span class="math inline">\(f'(x) = g'(h(x))h'(x)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Fancy Logarithm</td>
<td style="text-align: center;"><span class="math inline">\(f(x) = \ln(g(x))\)</span></td>
<td style="text-align: center;"><span class="math inline">\(f'(x) = \frac{g'(x)}{g(x)}\)</span> by Chain Rule</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Fancy Exponential</td>
<td style="text-align: center;"><span class="math inline">\(f(x) = e^{g(x)}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(f'(x) = g'(x)e^{g(x)}\)</span> by Chain Rule</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The reason why derivatives are so important for optimization is that we’re trying to <strong>climb a hill</strong> (for maximization; if we’re minimizing then we’re trying to <strong>reach the bottom of a lake</strong>)</p>
</section>
<section id="maximum-likelihood-estimation-as-unconstrained-optimization" class="level2">
<h2 class="anchored" data-anchor-id="maximum-likelihood-estimation-as-unconstrained-optimization">Maximum Likelihood Estimation as Unconstrained Optimization</h2>
<p>Now that we have this general procedure for non-constrained optimization in general, let’s use it to obtain a <strong>maximum likelihood estimate</strong> for some probabilistic model.</p>
<section id="standard-example-poisson-distribution" class="level3">
<h3 class="anchored" data-anchor-id="standard-example-poisson-distribution">“Standard” Example: Poisson Distribution</h3>
<p>We’ll start with an example more similar to the ones you did in DSAN 5100: estimating the rate parameter <span class="math inline">\(\param{\lambda}\)</span> for a random variable <span class="math inline">\(X\)</span> with a <strong>Poisson</strong> distribution.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Example 2: MLE for Poisson-Distributed RV">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example 2: MLE for Poisson-Distributed RV
</div>
</div>
<div class="callout-body-container callout-body">
<p>Given a dataset consisting of <span class="math inline">\(N\)</span> i.i.d. realizations <span class="math inline">\(\mathbf{x} = (x_1, \ldots, x_n)\)</span> of Poisson-distributed random variables</p>
<p><span class="math display">\[
X_1, \ldots, X_n \sim \text{Pois}(\param{\lambda}),
\]</span></p>
<p>find the <strong>Maximum Likelihood Estimate</strong> for the parameter <span class="math inline">\(\param{\lambda}\)</span>.</p>
</div>
</div>
<p>Like with other distributions we looked at in class, the way to approach problems like this is to write out the details step-by-step until you have enough information to start deriving the MLE. So, the first piece of information we have is:</p>
<ul>
<li>A random variable <span class="math inline">\(X \sim \text{Pois}(\param{\lambda})\)</span></li>
</ul>
<p>Given how the Poisson distribution works, this means that<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p><span id="eq-poisson-pdf"><span class="math display">\[
\Pr(X = k; \param{\lambda}) = \frac{\param{\lambda}^ke^{-\param{\lambda}}}{k!},
\tag{1}\]</span></span></p>
<p>where we can use probability <strong>mass</strong> <span class="math inline">\(\Pr(X = k)\)</span> rather than probability density <span class="math inline">\(f_X(k)\)</span> since the Poisson distribution is a <strong>discrete</strong> distribution (modeling integer <strong>counts</strong> rather than continuous values like the normal distribution).</p>
<p>The next piece of information we have, in a Maximum Likelihood setup, is an <strong>observed dataset</strong> containing <span class="math inline">\(N\)</span> i.i.d. datapoints,</p>
<ul>
<li><span class="math inline">\(\mathbf{x} = (x_1, \ldots, x_n)\)</span>,</li>
</ul>
<p>where each point is assumed to be drawn from this Poisson distribution with parameter <span class="math inline">\(\param{\lambda}\)</span>. This assumption means that we treat each of these observed points <span class="math inline">\(x_i\)</span> as the <strong>realization</strong> of a Poisson-distributed Random Variable <span class="math inline">\(X_i\)</span>, so that (by <a href="#eq-poisson-pdf" class="quarto-xref">Equation&nbsp;1</a> above):</p>
<p><span class="math display">\[
\Pr(X_i = x_i; \param{\lambda}) =  \frac{\param{\lambda}^{x_i}e^{-\param{\lambda}}}{x_i!},
\]</span></p>
<p>Our goal in Maximum Likelihood Estimation is to take this observed dataset and figure out what value of the parameter <span class="math inline">\(\param{\lambda}\)</span> is <strong>most likely</strong> to have produced <span class="math inline">\(\mathbf{x}\)</span>.</p>
<p>In other words, we are trying to find the value of <span class="math inline">\(\param{\lambda}\)</span> which maximizes the <strong>joint</strong> probability that <span class="math inline">\(X_1\)</span> is realized as <span class="math inline">\(x_1\)</span>, <span class="math inline">\(X_2\)</span>, is realized as <span class="math inline">\(x_2\)</span>, and so on up to <span class="math inline">\(X_n\)</span> being realized as <span class="math inline">\(x_n\)</span>, which we call the <strong>likelihood</strong> <span class="math inline">\(\mathcal{L}(\mathbf{x}; \param{\lambda})\)</span> of the dataset:</p>
<p><span class="math display">\[
\mathcal{L}(\mathbf{x}; \param{\lambda}) = \Pr(X_1 = x_1, X_2 = x_2, \ldots, X_n = x_n; \param{\lambda}).
\]</span></p>
<p>The key for being able to compute this giant joint probability is the <strong>independence assumption</strong>: since the values in <span class="math inline">\(\mathbf{x}\)</span> are assumed to be <strong>independent</strong> and <strong>identically distributed</strong> (i.i.d.), by the definition of independence, we can <strong>factor</strong> this full joint probability into the <strong>product</strong> of individual-variable probabilities:</p>
<p><span class="math display">\[
\begin{align*}
\mathcal{L}(\mathbf{x}; \param{\lambda}) &amp;= \Pr(X_1 = x_1, X_2 = x_2, \ldots, X_n = x_n; \param{\lambda}) \\
&amp;= \Pr(X_1 = x_1; \param{\lambda}) \times \cdots \times \Pr(X_n = x_n; \param{\lambda}) \\
&amp;= \prod_{i=1}^{N}\Pr(X_i = x_i; \param{\lambda})
\end{align*}
\]</span></p>
<p>This <strong>factoring</strong> into individual terms is the key to solving this problem! Now that we’ve done this, the rest of the problem boils down to a calculus problem. Let’s write out this product (which will look messy at first, but we’ll make it simpler using <span class="math inline">\(\log()\)</span> below!):</p>
<p><span class="math display">\[
\begin{align*}
\mathcal{L}(\mathbf{x}; \param{\lambda}) &amp;= \prod_{i=1}^{N}\Pr(X_i = x_i; \param{\lambda}) \\
&amp;= \prod_{i=1}^{N}\frac{\param{\lambda}^{x_i}e^{-\param{\lambda}}}{x_i!}
\end{align*}
\]</span></p>
<p>Because <span class="math inline">\(\log()\)</span> is a monotonic function, the value of <span class="math inline">\(x\)</span> which maximizes <span class="math inline">\(\log(f(x))\)</span> will be the same as the value which maximizes <span class="math inline">\(f(x)\)</span>. So, to make our lives easier since <span class="math inline">\(\log()\)</span> turns <strong>multiplications</strong> into <strong>additions</strong>, we compute the <strong>log-likelihood</strong> (the log of the likelihood function above), which we denote <span class="math inline">\(\ell(\mathbf{x}; \param{\lambda})\)</span>:</p>
<p><span class="math display">\[
\ell(\mathbf{x}; \param{\lambda}) = \log\left[ \prod_{i=1}^{N}\frac{\param{\lambda}^{x_i}e^{-\param{\lambda}}}{x_i!} \right]
\]</span></p>
<p>I recommend working through this application of <span class="math inline">\(\log()\)</span> yourself, if you can, then you can click the following button to show the worked-out solution:</p>
<details>
<summary>
Click to Show Solution
</summary>
<p><span class="math display">\[
\begin{align*}
\ell(\mathbf{x}; \param{\lambda}) &amp;= \log\left[ \prod_{i=1}^{N}\frac{\param{\lambda}^{x_i}e^{-\param{\lambda}}}{x_i!} \right] \\
&amp;= \sum_{i=1}^{N}\log\left[ \frac{\param{\lambda}^{x_i}e^{-\lambda}}{x_i!} \right] \\
&amp;= \sum_{i=1}^{N}\log (\param{\lambda}^{x_i}e^{-\lambda}) - \sum_{i=1}^N\log(x_i!) \\
&amp;= \sum_{i=1}^{N}x_i\log(\param{\lambda}) + \sum_{i=1}^{N}\log(e^{-\param{\lambda}}) - \sum_{i=1}^{N}\log(x_i!) \\
&amp;= \log(\param{\lambda})\sum_{i=1}^{N}x_i - N\param{\lambda} - \sum_{i=1}^{N}\log(x_i!).
\end{align*}
\]</span></p>
</details>
<p>This might look scary at first, for example, because of the term with the <span class="math inline">\(x_i!\)</span>. However, keep in mind that we won’t need to worry about this term, since it does not involve <span class="math inline">\(\param{\lambda}\)</span>, the parameter we are maximizing over!</p>
<p>So, following the same procedure as our previous example, we maximize this log-likelihood function with respect to <span class="math inline">\(\param{\lambda}\)</span>. We start by computing the derivative of <span class="math inline">\(\ell(\mathbf{x}; \param{\lambda})\)</span> with respect to <span class="math inline">\(\param{\lambda}\)</span>:</p>
<p><span class="math display">\[
\frac{\partial}{\partial \param{\lambda}}\ell(\mathbf{x}; \param{\lambda}) = \frac{\partial}{\partial \param{\lambda}}\left[ \log(\param{\lambda})\sum_{i=1}^{N}x_i - N\param{\lambda} - \sum_{i=1}^{N}\log(x_i!) \right]
\]</span></p>
<p>Like before, I recommend working through this yourself on paper, and then you can click the following to show the worked-out solution:</p>
<details>
<summary>
Click to Show Solution
</summary>
<p>Since both <span class="math inline">\(\sum_{i=1}^{N}x_i\)</span> and <span class="math inline">\(\sum_{i=1}^{N}\log(x_i!)\)</span> are <strong>constants</strong> with respect to <span class="math inline">\(\param{\lambda}\)</span>, and since the <strong>derivative operator</strong> <span class="math inline">\(\frac{\partial}{\partial\param{\lambda}}\)</span> is <strong>linear</strong>, this reduces to:</p>
<p><span class="math display">\[
\begin{align*}
\frac{\partial}{\partial \param{\lambda}}\ell(\mathbf{x}; \param{\lambda}) &amp;= \left( \sum_{i=1}^{N}x_i\right) \frac{\partial}{\partial \param{\lambda}}[\log(\param{\lambda})] - N\frac{\partial}{\partial\param{\lambda}}[\param{\lambda}] \\
&amp;= \frac{\sum_{i=1}^{N}x_i}{\param{\lambda}} - N.
\end{align*}
\]</span></p>
<p>And now we can set this equal to zero and solve to obtain the maximum-likelihood estimator <span class="math inline">\(\lambda^*\)</span>:</p>
<p><span class="math display">\[
\begin{align*}
&amp;\frac{\sum_{i=1}^{N}x_i}{\lambda^*} - N = 0 \\
\iff &amp;\frac{\sum_{i=1}^{N}x_i}{\lambda^*} = N \\
\iff &amp;\sum_{i=1}^{N}x_i = N\lambda^* \\
\iff &amp;\lambda^* = \frac{1}{N}\sum_{i=1}^{N}x_i,
\end{align*}
\]</span></p>
</details>
<p>meaning that, after all this work, the maximum likelihood estimator for a dataset containing realizations of i.i.d. Poisson RVs is the <strong>sample mean</strong> of those points, <span class="math inline">\(\frac{1}{N}\sum_{i=1}^{N}x_i\)</span>.</p>
<p>In other words, if you are given a dataset <span class="math inline">\(\mathbf{x} = (x_1, \ldots, x_n)\)</span>, and you think that the entries in this dataset were generated via the Poisson distribution, then the “best guess” (if we define “best guess” as “guess with maximum likelihood”) for the parameter <span class="math inline">\(\param{\lambda}\)</span> of this Poisson distribution is the sample mean of the observed points, <span class="math inline">\(\frac{1}{N}\sum_{i=1}^{N}x_i\)</span>.</p>
</section>
<section id="trickier-example-linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="trickier-example-linear-regression">Trickier Example: Linear Regression</h3>
<p>Since I think <strong>linear regression</strong> is a really important model to have in the back of your mind as you move towards fancier Machine Learning models, but is a bit more complex than the Poisson case we just looked at, a good starting point is an <strong>over-simplified</strong> version of linear regression, where we don’t even have an intercept.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Example 3: Zero-Intercept Linear Regression">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example 3: Zero-Intercept Linear Regression
</div>
</div>
<div class="callout-body-container callout-body">
<p>Assume we have a dataset <span class="math inline">\(\mathbf{d} = ((x_1,y_1),\ldots,(x_N,y_N))\)</span> containing <strong>noisy</strong> observations from some underlying linear relationship <span class="math inline">\(y = \param{\beta} x\)</span>, so that we model what we observe in <span class="math inline">\(\mathbf{d}\)</span> as realizations of random variables <span class="math inline">\(X\)</span>, <span class="math inline">\(Y\)</span>, and <span class="math inline">\(\varepsilon_i\)</span>:</p>
<p><span class="math display">\[
Y_i = \param{\beta} X_i + \varepsilon_i,
\]</span></p>
<p>where the variables <span class="math inline">\(\varepsilon_i\)</span> are i.i.d. normally-distributed variables with mean <strong>zero</strong> and a given variance <span class="math inline">\(\sigma^2\)</span>: <span class="math inline">\(\varepsilon_i \sim \mathcal{N}(0, \sigma^2)\)</span>.</p>
<p>Find the <strong>Maximum Likelihood Estimator</strong> for the single parameter in this case, <span class="math inline">\(\param{\beta}\)</span>.</p>
</div>
</div>
<p>Note that in general, if a random variable <span class="math inline">\(X\)</span> is distributed normally, then adding things to <span class="math inline">\(X\)</span> just shifts the <strong>mean</strong> parameter <span class="math inline">\(\mu\)</span> (meaning, for example, if <span class="math inline">\(X \sim \mathcal{N}(\mu, \sigma)\)</span>, then <span class="math inline">\(X + 3 \sim \mathcal{N}(\mu + 3, \sigma)\)</span>).</p>
<p>Here, since <span class="math inline">\(\varepsilon_i\)</span> is a normally-distributed random variable with <span class="math inline">\(\mu = 0\)</span>, the left-hand side of the above equation means that <span class="math inline">\(Y_i \sim \mathcal{N}(\param{\beta} X_i, \sigma)\)</span>.</p>
<p>Just as we used the <strong>Poisson</strong> PMF in the previous example, here you will use the <strong>Normal</strong> pdf, the probability density function for <span class="math inline">\(Y_i\)</span> in this case, which is typically denoted using the Greek letter <span class="math inline">\(\varphi\)</span> (“Phi”):</p>
<p><span class="math display">\[
\varphi(v; \param{\mu}, \param{\sigma}) = \frac{1}{\sqrt{2\pi}\sigma}\exp\left[-\frac{1}{2}\left(\frac{v - \mu}{\sigma}\right)^2\right].
\]</span></p>
<p>Although in this “standard form” for the pdf of the normal distribution the two parameters are <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>, in our case note that we are <strong>not</strong> estimating the parameters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> itself. Instead, we are estimating a single parameter <span class="math inline">\(\param{\beta}\)</span>, which is <strong>not</strong> the mean or standard deviation itself, though it ends up affecting the mean since <span class="math inline">\(Y_i \sim \mathcal{N}(\param{\beta} X_i, \sigma)\)</span>.</p>
<p>So, the way we obtain the <strong>likelihood</strong> which we can then use to estimate <span class="math inline">\(\param{\beta}\)</span> is by <strong>plugging <span class="math inline">\(\param{\beta} X_i\)</span> into the pdf above</strong>, to obtain:</p>
<p><span class="math display">\[
\begin{align*}
\mathcal{L}(\mathbf{d}; \param{\beta}) &amp;= \prod_{i=1}^{N}\varphi(y_i; \param{\beta}x_i, \sigma) \\
&amp;= \prod_{i=1}^{N}\frac{1}{\sqrt{2\pi}\sigma}\exp\left[ -\frac{1}{2}\left(\frac{y_i - \param{\beta}x_i}{\sigma}\right)^2 \right]
\end{align*}
\]</span></p>
<p>Like in the Poisson case, this looks scary until you transform it into the <strong>log</strong>-likelihood function, at which point lots of things simplify and you can compute a closed-form solution!</p>
<details>
<summary>
Click to Show Solution
</summary>
<p><span class="math display">\[
\begin{align*}
\ell(\mathbf{d}; \param{\beta}) &amp;= \log\left[ \prod_{i=1}^{N}\frac{1}{\sqrt{2\pi}\sigma}\exp\left[ -\frac{1}{2}\left(\frac{y_i - \param{\beta}x_i}{\sigma}\right)^2 \right] \right] \\
&amp;= \sum_{i=1}^{N}\log\left[ \frac{1}{\sqrt{2\pi}\sigma}\exp\left[ -\frac{1}{2}\left(\frac{y_i - \param{\beta}x_i}{\sigma}\right)^2 \right] \right] \\
&amp;= \sum_{i=1}^{N}-\log\left(\sqrt{2\pi}\sigma \right) - \frac{1}{2}\sum_{i=1}^{N}\left(\frac{y_i - \param{\beta} x_i}{\sigma}\right)^2 \\
&amp;= -N\log\left(\sqrt{2\pi}\sigma \right) - \frac{1}{2\sigma^2}\sum_{i=1}^{N}\left(y_i - \param{\beta} x_i\right)^2.
\end{align*}
\]</span></p>
<p>And we now have the log-likelihood in a form where we can compute a derivative straightforwardly (using the derivative “rules” in the table presented earlier):</p>
<p><span class="math display">\[
\begin{align*}
\frac{\partial}{\partial\param{\beta}}\ell(\mathbf{d}; \param{\beta}) &amp;= \frac{\partial}{\partial\param{\beta}}\left[ -N\log\left(\sqrt{2\pi}\sigma \right) - \frac{1}{2\sigma^2}\sum_{i=1}^{N}\left(y_i - \param{\beta} x_i\right)^2 \right] \\
&amp;= -\frac{1}{2\sigma^2} \sum_{i=1}^{N}\frac{\partial}{\partial\param{\beta}}\left[ (y_i - \param{\beta}x_i)^2 \right] \\
&amp;= -\frac{1}{\sigma^2}\sum_{i=1}^{N}(y_i-\param{\beta}x_i)x_i \\
&amp;= -\frac{1}{\sigma^2}\left[\sum_{i=1}^{N}x_iy_i - \param{\beta}\sum_{i=1}^{N}x_i^2\right].
\end{align*}
\]</span></p>
<p>By setting this equal to zero, we can now solve for the MLE estimator <span class="math inline">\(\beta^*\)</span>:</p>
<p><span class="math display">\[
\begin{align*}
&amp;-\frac{1}{\sigma^2}\left[\sum_{i=1}^{N}x_iy_i - \param{\beta}\sum_{i=1}^{N}x_i^2\right] = 0 \\
\iff &amp;\sum_{i=1}^{N}x_iy_i - \param{\beta}\sum_{i=1}^{N}x_i^2 = 0 \\
\iff &amp;\sum_{i=1}^{N}x_iy_i = \param{\beta}\sum_{i=1}^{N}x_i^2,
\end{align*}
\]</span></p>
<p>And thus the MLE for <span class="math inline">\(\param{\beta}\)</span> in this case is</p>
<p><span class="math display">\[
\widehat{\beta}_{MLE} = \frac{\sum_{i=1}^{N}x_iy_i}{\sum_{i=1}^{N}x_i^2}.
\]</span></p>
</details>
<p>This means that, if we want the line of “best” fit for a dataset <span class="math inline">\(\mathbf{d} = ((x_1,y_1),\ldots,(x_n,y_n))\)</span>, where “best fit” is defined to be “slope with maximum likelihood, with intercept 0”, this line is</p>
<p><span class="math display">\[
y = \widehat{\beta}_{MLE}x = \frac{\sum_{i=1}^{N}x_iy_i}{\sum_{i=1}^{N}x_i^2}x.
\]</span></p>
</section>
</section>
<section id="general-constraints-only-optimization" class="level2">
<h2 class="anchored" data-anchor-id="general-constraints-only-optimization">General Constraints-Only Optimization</h2>
<p>Seeing an optimization problem written out with <strong>only</strong> constraints looks a bit weird at first, but will be helpful to consider before we look at full-on constrained optimization.</p>
<p>Like how we looked at a “basic” calculus problem before applying the same methodology to MLE before, here let’s look at a “basic” algebra problem with inequalities:</p>
<div class="callout callout-style-default callout-note callout-titled" title="Example 4: Inequality Constraints">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example 4: Inequality Constraints
</div>
</div>
<div class="callout-body-container callout-body">
<p>Find the value <span class="math inline">\(x^*\)</span> which satisfies the system of inequalities</p>
<p><span class="math display">\[
\begin{alignat}{2}
x^* = &amp;&amp;\max_{x} \quad &amp;f(x,y) = 0 \\
&amp;&amp;\text{s.t.} \quad &amp; y \geq x^2 + 1 \\
&amp;&amp; \quad &amp; y \leq \sqrt{1 - x^2}
\end{alignat}
\]</span></p>
</div>
</div>
<p>It looks weird at first because, the <span class="math inline">\(\max_x\)</span> portion doesn’t give us anything to work with: we’re “maximizing” <span class="math inline">\(f(x)\)</span> which is always just the number <span class="math inline">\(0\)</span>! So, instead, we focus on just the <strong>constraints</strong>:</p>
<ul>
<li><span class="math inline">\(y \geq x^2 + 1\)</span></li>
<li><span class="math inline">\(y \leq \sqrt{1 - x^2}\)</span></li>
</ul>
<p>Plotting these two functions, we can see that they meet at exactly one point:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(latex2exp)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>x_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>f1_lab <span class="ot">&lt;-</span> <span class="fu">TeX</span>(<span class="st">"$y </span><span class="sc">\\</span><span class="st">geq x^2 + 1$"</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>f2_lab <span class="ot">&lt;-</span> <span class="fu">TeX</span>(<span class="st">"$y </span><span class="sc">\\</span><span class="st">leq </span><span class="sc">\\</span><span class="st">sqrt{1 - x^2}$"</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>soln_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="dv">1</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>x_df <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x)) <span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun=</span>f1, <span class="at">color=</span><span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun=</span>f1, <span class="at">geom=</span><span class="st">"ribbon"</span>, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">ymin=</span><span class="fu">after_stat</span>(y),<span class="at">ymax=</span><span class="dv">4</span>, <span class="at">fill=</span><span class="st">"f1"</span>), <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun=</span>f2, <span class="at">color=</span><span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun=</span>f2, <span class="at">geom=</span><span class="st">"area"</span>, <span class="fu">aes</span>(<span class="at">fill=</span><span class="st">"f2"</span>), <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>soln_df, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)) <span class="sc">+</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Constraints:"</span>,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">values=</span><span class="fu">c</span>(cb_palette[<span class="dv">1</span>], cb_palette[<span class="dv">2</span>]),</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels=</span><span class="fu">c</span>(f1_lab, f2_lab)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/ineq-constraints-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>which means that we can solve for where they’re equal to derive the unique optimal solution <span class="math inline">\(x^*\)</span>!</p>
<p><span class="math display">\[
\begin{align*}
&amp;x^2 + 1 = \sqrt{1 - x^2} \\
\iff &amp;(x^2 + 1)^2 = 1 - x^2 \\
\iff &amp; x^4 + 2x^2 + 1 = 1 - x^2 \\
\iff &amp; x^4 + 3x^2 = 0 \\
\iff &amp; x^2(x^2 + 3) = 0,
\end{align*}
\]</span></p>
<p>which means that the only possible solutions are the solutions to <span class="math inline">\(x^2 = 0\)</span> and <span class="math inline">\(x^2 + 3 = 0\)</span>. The only <span class="math inline">\(x\)</span> which satisfies <span class="math inline">\(x^2 = 0\)</span> is <span class="math inline">\(x^* = 0\)</span>. The only <span class="math inline">\(x\)</span> which satisfies <span class="math inline">\(x^2 + 3 = 0\)</span> is <span class="math inline">\(x^* = \sqrt{-3}= \pm 3i\)</span>, meaning that our only <strong>real</strong> solution is <span class="math inline">\(x^* = 0\)</span>, forming the unique (real) solution to our optimization problem.</p>
</section>
<section id="gmm-estimation-as-constraints-only-optimization" class="level2">
<h2 class="anchored" data-anchor-id="gmm-estimation-as-constraints-only-optimization">GMM Estimation as Constraints-Only Optimization</h2>
<p>The Generalized Method of Moments approach basically takes advantage of the type of “crunching” we saw in the previous example, setting up a system of equations which “crunches” the set of possible values for the desired parameter <span class="math inline">\(\param{\theta}\)</span> down into just a single value.</p>
<p>It is able to accomplish this, basically, by saying:</p>
<p><em>If the entries in our dataset <span class="math inline">\(\mathbf{x} = (x_1, \ldots, x_n)\)</span> are realizations of RVs <span class="math inline">\(X_1, \ldots, X_n\)</span> drawn i.i.d. from some distribution <span class="math inline">\(\mathcal{D}(\param{\boldsymbol\theta})\)</span> with parameters <span class="math inline">\(\param{\boldsymbol\theta}\)</span>, then the <strong>moments</strong> of the theoretical distribution <span class="math inline">\(\mathcal{D}(\param{\boldsymbol\theta})\)</span> should <strong>match</strong> their observed counterparts.”</em></p>
<p>Specifically, <span class="math inline">\(\param{\boldsymbol\theta}\)</span> should be the value which makes the:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 40%">
<col style="width: 20%">
<col style="width: 40%">
</colgroup>
<tbody>
<tr class="odd">
<td><strong>Expected mean</strong> <span class="math inline">\(\mu = \mathbb{E}[X_i]\)</span> of <span class="math inline">\(X_i \sim \mathcal{D}(\param{\boldsymbol\theta})\)</span></td>
<td style="text-align: center;">equal to the</td>
<td><strong>observed mean</strong> of the dataset, <span class="math inline">\(\widehat{\mu} = \frac{1}{N}\sum_{i=1}^{N}x_i\)</span></td>
</tr>
<tr class="even">
<td><strong>Expected variance</strong> <span class="math inline">\(\sigma^2 = \mathbb{E}[(X_i - \mu)^2]\)</span> of <span class="math inline">\(X_i \sim \mathcal{D}(\param{\boldsymbol\theta})\)</span></td>
<td style="text-align: center;">equal to the</td>
<td><strong>observed variance</strong> of the dataset, <span class="math inline">\(\widehat{\sigma^2} = \frac{1}{N}\sum_{i=1}^{N}(x_i - \widehat{\mu})^2\)</span></td>
</tr>
<tr class="odd">
<td><strong>Expected skewness</strong> <span class="math inline">\(\gamma = \mathbb{E}[(X_i - \mu)^3]\)</span> of <span class="math inline">\(X_i \sim \mathcal{D}(\param{\boldsymbol\theta})\)</span></td>
<td style="text-align: center;">equal to the</td>
<td><strong>observed skewness</strong> of the dataset, <span class="math inline">\(\widehat{\gamma} = \frac{1}{N}\sum_{i=1}^{N}(x_i - \widehat{\mu})^3\)</span></td>
</tr>
<tr class="even">
<td><strong>Expected kurtosis</strong> <span class="math inline">\(\kappa = \mathbb{E}[(X_i - \mu)^4]\)</span> of <span class="math inline">\(X_i \sim \mathcal{D}(\param{\boldsymbol\theta})\)</span></td>
<td style="text-align: center;">equal to the</td>
<td><strong>observed skewness</strong> of the dataset, <span class="math inline">\(\widehat{\kappa} = \frac{1}{N}\sum_{i=1}^{N}(x_i - \widehat{\mu})^4\)</span></td>
</tr>
</tbody>
</table>
<p>and so on—as many equations as we need to estimate the parameters <span class="math inline">\(\param{\boldsymbol\theta}\)</span> of the distribution <span class="math inline">\(\mathcal{D}\)</span>!</p>
<p>So, let’s repeat the earlier problem with the Poisson distribution, <strong>using GMM instead of MLE</strong>, to compute an estimator for the rate parameter <span class="math inline">\(\param{\lambda}\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Example 5: GMM Estimate for Poisson-Distributed RV">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example 5: GMM Estimate for Poisson-Distributed RV
</div>
</div>
<div class="callout-body-container callout-body">
<p>Given a dataset consisting of <span class="math inline">\(N\)</span> i.i.d. realizations <span class="math inline">\(\mathbf{x} = (x_1, \ldots, x_n)\)</span> of Poisson-distributed random variables</p>
<p><span class="math display">\[
X_1, \ldots, X_n \sim \text{Pois}(\param{\lambda}),
\]</span></p>
<p>find the <strong>Generalized Method of Moments</strong> estimate for the parameter <span class="math inline">\(\param{\lambda}\)</span>.</p>
</div>
</div>
<p>Here, since our distribution only has <strong>one</strong> parameter <span class="math inline">\(\param{\lambda}\)</span>, we only need <strong>one</strong> equation in our system of equations, which will “match” the expected value of a Poisson-distributed RV with the mean of our dataset <span class="math inline">\(\mathbf{x}\)</span>:</p>
<p><span class="math display">\[
\begin{align*}
&amp;\mu = \widehat{\mu} \\
\iff &amp;\mathbb{E}[X_i] = \frac{1}{N}\sum_{i=1}^{N}x_i \\
\iff &amp;\param{\lambda} = \frac{1}{N}\sum_{i=1}^{N}x_i
\end{align*}
\]</span></p>
<p>And… yup, that’s it! Since the expected value of a poisson-distributed Random Variable <span class="math inline">\(X_i\)</span> is just exactly the rate parameter <span class="math inline">\(\param{\lambda}\)</span><a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>, we’ve obtained the GMM estimate of <span class="math inline">\(\param{\lambda}\)</span> as desired here, and we see that in fact the GMM estimator is the <strong>same as</strong> the MLE estimator in this case.</p>
</section>
<section id="general-constrained-optimization" class="level2">
<h2 class="anchored" data-anchor-id="general-constrained-optimization">General Constrained Optimization</h2>
<p>Though we introduced <a href="#general-unconstrained-optimization">objective functions</a> and <a href="#general-constraints-only-optimization">constraints</a> separately here, in reality most problems will require you to optimize with respect to <strong>both</strong> of these to find the solution to your problem.</p>
<p>To use the example I used throughout the semester one more time: if you are trying to estimate the <strong>population mean height</strong> from a sample of heights, you may want to have:</p>
<ul>
<li>An <strong>objective function</strong> quantifying how “good” a normal distribution <span class="math inline">\(\mathcal{N}(\mu, \sigma^2)\)</span> is in terms of fitting the data (this would be precisely the <strong>likelihood function</strong>), but also</li>
<li>A <strong>constraint</strong> on <span class="math inline">\(\mu\)</span> to ensure that you don’t get negative values (since heights in reality can’t be negative), and perhaps another constraint to ensure that you don’t get absurdly high numbers in the millions and billions as well.</li>
</ul>
<p>While you’ve seen likelihood functions, constraints in optimization world are written out as:</p>
<ul>
<li><strong>Equalities</strong> like <span class="math inline">\(\sum_{i=1}^{N}\theta_i = 1\)</span> or</li>
<li><strong>Inequalities</strong> like <span class="math inline">\(\theta_i &lt; 0.5 ~ \forall i\)</span>.</li>
</ul>
<p>So, for the normal distribution example just mentioned, you could introduce <strong>inequality constraints</strong> to re-write the problem in the following form (where we just include the non-negative constraint, for simplicity):</p>
<p><span class="math display">\[
\begin{alignat}{2}
\boldsymbol\theta^* = &amp;&amp;\max_{\param{\mu}, \sigma} \quad &amp;\mathcal{L}(X = v_X \mid \param{\mu}, \sigma) \\
&amp;&amp; \text{s.t.} \quad &amp; \param{\mu} &gt; 0
\end{alignat}
\]</span></p>
<p>These two working together (the objective function and the constraints), it turns out, will <strong>“supercharge”</strong> your estimation! Now, instead of just guessing a random number from <span class="math inline">\(-\infty\)</span> to <span class="math inline">\(\infty\)</span> as your initial guess for <span class="math inline">\(\widehat{\mu}\)</span>, you have the power to “guide” the optimization by (say) starting at the lower bound on <span class="math inline">\(\widehat{\mu}\)</span>, in this case, 0.</p>
<p>For solving <strong>by hand</strong>, though, we’ll need to use a technique called the <strong>Lagrange Multiplier</strong> approach, to turn this <strong>constrained</strong> optimization problem back into an <strong>unconstrained</strong> optimization, since this is the case where we know how to use calculus to solve!</p>
<div class="callout callout-style-default callout-note callout-titled" title="Example 6: Constrained Optimization via Lagrange Multipliers">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example 6: Constrained Optimization via Lagrange Multipliers
</div>
</div>
<div class="callout-body-container callout-body">
<p>Find the optimal value <span class="math inline">\(x^*\)</span> for the following optimization problem:</p>
<p><span class="math display">\[
\begin{alignat}{2}
x^* = &amp;&amp;\min_{x} \quad &amp;f(x, y) = 2 - x^2 - 2y^2 \\
&amp;&amp; \text{s.t.} \quad &amp; x^2 + y^2 = 1
\end{alignat}
\]</span></p>
</div>
</div>
<p>We can visualize the two “pieces” of this optimization, to see (finally!) how the objective function and the constraints come together:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>my_f <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y) <span class="dv">2</span> <span class="sc">-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>y<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>x_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">to=</span><span class="dv">2</span>, <span class="at">by=</span><span class="fl">0.1</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>y_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">to=</span><span class="dv">2</span>, <span class="at">by=</span><span class="fl">0.1</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>data_df <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">x=</span>x_vals, <span class="at">y=</span>y_vals)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>data_df <span class="ot">&lt;-</span> data_df <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">z =</span> <span class="fu">my_f</span>(x, y)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>data_df <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">z=</span>z)) <span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_rect(xmin=0, xmax=1, ymin=-Inf, ymax=Inf, alpha=0.5, fill=cb_palette[1]) +</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_vline(xintercept=0, linewidth=0.75) +</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>(<span class="at">alpha=</span><span class="fl">0.9</span>, <span class="at">binwidth =</span> <span class="fl">0.5</span>, <span class="at">color=</span><span class="st">'black'</span>, <span class="at">linewidth=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_circle</span>(<span class="fu">aes</span>(<span class="at">x0=</span><span class="dv">0</span>, <span class="at">y0=</span><span class="dv">0</span>, <span class="at">r=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="dv">0</span>, <span class="at">xend=</span><span class="dv">1</span>, <span class="at">yend=</span><span class="dv">0</span>), <span class="at">linetype=</span><span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option=</span><span class="st">"C"</span>) <span class="sc">+</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme(legend.position="none") +</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-constrained-opt" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-constrained-opt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-constrained-opt-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-constrained-opt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: The goal of our constrained optimization problem is to find the optimal value(s) <span class="math inline">\((x^*,y^*)\)</span> which maximize <span class="math inline">\(f(x,y)\)</span> (higher values are brighter yellow here), subject to the constraint that the point <span class="math inline">\((x^*, y^*)\)</span> lies on the <strong>unit circle</strong>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Sadly, our earlier approach of finding the derivative of the objective function, setting it equal to zero, and solving, won’t work here. Let’s see why. First compute the partial derivatives:</p>
<p><span class="math display">\[
\begin{align*}
\frac{\partial}{\partial x}f(x,y) = -2x \\
\frac{\partial}{\partial y}f(x,y) = -4y
\end{align*}
\]</span></p>
<p>Then set them equal to zero and solve the system of equations:</p>
<p><span class="math display">\[
\begin{align*}
\frac{\partial}{\partial x}f(x,y) = 0 \iff -2x^* = 0 \iff &amp;\boxed{x^* = 0} \\
\frac{\partial}{\partial y}f(x,y) = 0 \iff -4y^* = 0 \iff &amp;\boxed{y^* = 0}.
\end{align*}
\]</span></p>
<p>We can see now that our computed optimal point, <span class="math inline">\((0, 0)\)</span>, <strong>violates</strong> the desired constraint, since it does <strong>not</strong> lie on the unit circle <span class="math inline">\(x^2 + y^2 = 1\)</span>:</p>
<p><span class="math display">\[
(x^*)^2 + (y^*)^2 = 0^2 + 0^2 = 0 \neq 1.
\]</span></p>
<p>The Lagrange Multiplier approach comes to the rescue here, because it allows us to use this same derivative-based method by <strong>incorporating</strong> the constraints into the function we take the derivative of and set equal to zero to solve.</p>
<p>The new approach you can use to solve for <span class="math inline">\(x^*\)</span> in situations like this is based on constructing a <strong>new function</strong> <span class="math inline">\(\mathscr{L}(x, y, \lambda)\)</span>, called the <strong>Lagrangian</strong>, where the new parameter <span class="math inline">\(\lambda\)</span> is just the coefficient on a <strong>constraint function</strong> <span class="math inline">\(g(x, y)\)</span>.</p>
<p>This <span class="math inline">\(g(x, y)\)</span> may seem complicated at first, but I think of it like a “helper function” which you derive from the constraint(s), finding a <span class="math inline">\(g(x, y)\)</span> such that:</p>
<ul>
<li><span class="math inline">\(g(x) = 0\)</span> when the constraint is satisfied, and</li>
<li><span class="math inline">\(g(x) \neq 0\)</span> when the constraint is violated.</li>
</ul>
<p>In our case, therefore, we can rewrite the constraint like:</p>
<p><span class="math display">\[
x^2 + y^2 = 1 \iff x^2 + y^2 - 1 = 0,
\]</span></p>
<p>and choose our <span class="math inline">\(g(x,y)\)</span> to be the left side of this equation: <span class="math inline">\(g(x,y) = x^2 + y^2 - 1\)</span>.</p>
<p>With our constraint function now chosen, we construct the <strong>Lagrangian</strong>:</p>
<p><span class="math display">\[
\begin{align*}
\mathscr{L}(x, \lambda) &amp;= f(x) + \lambda g(x) = 2 - x^2 - 2y^2 + \lambda(x^2 + y^2 - 1) \\
&amp;= 2 - x^2 - 2y^2 + \lambda x^2 + \lambda y^2 - \lambda
\end{align*}
\]</span></p>
<p>and optimize in the same way we’ve always optimized via calculus, making sure to compute <strong>all</strong> three of the partial derivatives:</p>
<ul>
<li><p>With respect to <span class="math inline">\(x\)</span>:</p>
<p><span class="math display">\[
\frac{\partial \mathscr{L}}{\partial x} = -2x + 2\lambda x
\]</span></p></li>
<li><p>With respect to <span class="math inline">\(y\)</span>:</p>
<p><span class="math display">\[
\frac{\partial \mathscr{L}}{\partial y} = -4y + 2\lambda y
\]</span></p></li>
<li><p>And with respect to <span class="math inline">\(\lambda\)</span>:</p>
<p><span class="math display">\[
\frac{\partial \mathscr{L}}{\partial \lambda} = x^2 + y^2 - 1
\]</span></p></li>
</ul>
<p>we can now set <strong>all</strong> of these derivatives equal to zero, to obtain a system of equations:</p>
<p><span class="math display">\[
\begin{align*}
-2x + 2\lambda x &amp;= 0 \\
-4y + 2\lambda y &amp;= 0 \\
x^2 + y^2 - 1 &amp;= 0
\end{align*}
\]</span></p>
<p>There are a few ways to solve this system (including using matrices!), but here’s how I solved it, by solving for <span class="math inline">\(\lambda^*\)</span> first:</p>
<p><span class="math display">\[
\begin{align*}
-2x + 2\lambda^* x = 0 \iff 2\lambda^* x = 2x \iff \boxed{\lambda^* = 1},
\end{align*}
\]</span></p>
<p>then deriving the value of <span class="math inline">\(y\)</span>:</p>
<p><span class="math display">\[
\begin{align*}
&amp;-4y^* + 2\lambda^* y^* = 0 \iff -4y^* + 2(1)y^* = 0 \\
&amp;\iff -4y^* + 2y^* = 0 \iff \boxed{y^* = 0},
\end{align*}
\]</span></p>
<p>and <span class="math inline">\(x\)</span>:</p>
<p><span class="math display">\[
\begin{align*}
&amp;(x^*)^2 + (y^*)^2 - 1 = 0 \iff (x^*)^2 + (0)^2 - 1 = 0 \\
&amp;\iff (x^*)^2 = 1 \iff \boxed{x^* = \pm 1}
\end{align*}
\]</span></p>
<p>And indeed, by looking at the plot in <a href="#fig-constrained-opt" class="quarto-xref">Figure&nbsp;1</a> above, we see that <span class="math inline">\((-1,0)\)</span> and <span class="math inline">\((1,0)\)</span> are the two optimal values here!</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-boyd_convex_2004" class="csl-entry" role="listitem">
Boyd, Stephen P., and Lieven Vandenberghe. 2004. <em>Convex <span>Optimization</span></em>. Cambridge University Press. <a href="https://web.stanford.edu/~boyd/cvxbook/bv_cvxbook.pdf">https://web.stanford.edu/~boyd/cvxbook/bv_cvxbook.pdf</a>.
</div>
</div>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>A somewhat important point, but I thought I’d make it a footnote in case it’s already clear to some folks: when you enter the “world” of optimization problems, you stop caring so much about whether the problem is a <strong>maximization</strong> or <strong>minimization</strong> problem. Instead, you literally just use whichever is easier to compute: the <strong>max</strong> of <span class="math inline">\(f(x)\)</span> or the <strong>min</strong> of <span class="math inline">\(-f(x)\)</span>. To be a little more specific: in <strong>convex</strong> optimization, the most general type of optimization we have efficient algorithms for, you always <strong>minimize</strong>, and then just transform <span class="math inline">\(f(x)\)</span> into <span class="math inline">\(-f(x)\)</span> if your original intent was to maximize (this is… by convention essentially. See <span class="citation" data-cites="boyd_convex_2004">Boyd and Vandenberghe (<a href="#ref-boyd_convex_2004" role="doc-biblioref">2004</a>)</span> for more!).<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Note how we use “;” to separate random variables like <span class="math inline">\(X\)</span> in this case from non-random variables like <span class="math inline">\(\lambda\)</span> in this case: sometimes people use the conditional operator “|” for this, but that can sometimes lead to confusion since <strong>conditioning</strong> on the value of a <strong>Random Variable</strong> is different from having the value of a <strong>non</strong>-random variable as a parameter to the function.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>You can find a proof of this fact <a href="https://statproofbook.github.io/P/poiss-mean.html">here</a>.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jpowerj/dsan5300-01/blob/main/writeups/optimization/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div></div></div></footer></body></html>